<mat-card appearance='outlined' class='card-primary back_light-title'>
  <mat-card-content>
    <p class='title'>Correspondencia de oficios</p>
  </mat-card-content>
</mat-card>
@if(this.nuev == '1'){
<div class='row'>
  <div class='col-2'>
    <mat-card (click)='getEstatus(5)' [ngClass]="{'carta': true, 'activa': estatusConsulta === 5}">
      <div class='icono'>
        <i class='material-icons md-36'>folder_open</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Ver todos los oficios</p>
      </mat-card-content>
    </mat-card>
  </div>
  <div class='col-2'>
    <mat-card (click)='getEstatus(1)'  [ngClass]="{'carta': true, 'activa': estatusConsulta === 1}">
      <div class='icono'>
        <i class='material-icons md-36'>folder_managed</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Ver oficios nuevos </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div class='col-2'>
     <mat-card (click)='getEstatus(2)'  [ngClass]="{'carta': true, 'activa': estatusConsulta === 2}">
      <div class='icono'>
        <i class='material-icons md-36'>disabled_visible</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Ver oficios (solo en visto) </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div class='col-2'>
     <mat-card (click)='getEstatus(3)'  [ngClass]="{'carta': true, 'activa': estatusConsulta === 3}">
      <div class='icono'>
        <i class='material-icons md-36'>approval</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Ver oficios con sello </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div class='col-2'>
     <mat-card (click)='getEstatus(4)'  [ngClass]="{'carta': true, 'activa': estatusConsulta === 4}">
      <div class='icono'>
        <i class='material-icons md-36'>engineering</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Ver oficios asignados </p>
      </mat-card-content>
    </mat-card>
  </div>
  <div class='col-2'>
    <mat-card (click)='exportAsXLSX()' class='carta'>
      <div class='icono'>
        <i class='material-icons md-36'>table_view</i>
      </div>
      <mat-card-header>
        <mat-card-title class='titulo'>
          <p></p>
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p class='texto'>Generar Excel gestion_oficios </p>
      </mat-card-content>
    </mat-card>
  </div>
</div>
}

<div class='row mt-2'>
  <mat-card appearance='outlined'>
    <div class='row mt-2'>
      <mat-card-content>
        <mat-form-field>
          <mat-label>Búsqueda </mat-label>
          <input matInput (keyup)='applyFilter($event)' placeholder='Escriba un parámetro para su búsqueda.' #input />
        </mat-form-field>

        <div class='mat-elevation-z8'>
          <table mat-table [dataSource]='dataSource' matSort>

            <ng-container matColumnDef='activo'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                activo
              </th>
              <td mat-cell *matCellDef='let element'
                [ngStyle]='{"background-color": cambiarColorActivo(element.activo)}'>
                {{ element.activo}}
              </td>
            </ng-container>
            <ng-container matColumnDef='id_usuario'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                id_usuario
              </th>
              <td mat-cell *matCellDef='let element' [ngStyle]='{"background-color": cambiarColor(element.estatus)}'>
                {{ element.id_usuario}}
              </td>
            </ng-container>
            <ng-container matColumnDef='id_gestion_oficios'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                id gestion_oficios
              </th>
              <td mat-cell *matCellDef='let element' [ngStyle]='{"background-color": cambiarColor(element.estatus)}'>
                {{ element.id_gestion_oficios}}
              </td>
            </ng-container>

            <ng-container matColumnDef='id_oficios'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                id_oficios
              </th>
              <td mat-cell *matCellDef='let element' [ngStyle]='{"background-color": cambiarColor(element.estatus)}'>
                {{ element.id_oficios}} -{{element.numero_oficio}}
              </td>
            </ng-container>
            <ng-container matColumnDef='asunto'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                Asunto
              </th>
              <td mat-cell *matCellDef='let element' [ngStyle]='{"background-color": cambiarColor(element.estatus)}'>
                <p style="font-size: x-larger; text-align: justify; font-weight: bold;">{{ element.asunto}}</p>
              </td>
            </ng-container>
            <ng-container matColumnDef="estatus">
              <th mat-header-cell *matHeaderCellDef mat-sort-header>
                Estatus
              </th>
              <td mat-cell *matCellDef="let element">
                <mat-chip [color]="element.visual?.color" selected>
                  <mat-icon>{{ element.visual?.icon }}</mat-icon>
                  {{ element.visual?.label }}
                </mat-chip>
              </td>
            </ng-container>
            <ng-container matColumnDef='createdAt'>
              <th mat-header-cell *matHeaderCellDef mat-sort-header
                style="font-size: 16px; padding: 16px 24px; min-width: 150px;">
                Fecha de término
              </th>
              <td mat-cell *matCellDef="let element">
                <div style="font-size: larger;">
                  <strong>petición de terminó:</strong> {{ element.fecha_hora | date: 'dd/MM/yyyy' }}
                </div>
                <div class="alerta-hora" style="display: flex; align-items: center; gap: 8px;">
                  <strong>Restante:</strong> {{ getTiempoRestante(element.fecha_hora) }}
                  <span class="semaforo" [ngClass]="getSemaforoColor(element.fecha_hora)"
                    style="width: 12px; height: 12px; border-radius: 50%; display: inline-block;"></span>
                </div>
              </td>
            </ng-container>
            <ng-container matColumnDef='Funciones'>
              <th class='text-center' mat-header-cell *matHeaderCellDef>
                Funciones
              </th>
              <td mat-cell *matCellDef='let element' [ngStyle]='{"background-color": cambiarColor(element.estatus)}'>
                <div class='example-flex-container text-center'>

                  @if(element.id_gestion_oficios != null ){
                  <button mat-mini-fab aria-label='Example icon button with a menu icon'
                    style='background-color: rgb(250, 250, 250)' matTooltip='Ver el registro'
                    (click)='vercorrespondencia(element.id_gestion_oficios,element.id_oficios)'>
                    <mat-icon>visibility</mat-icon>
                  </button>

                  <!-- @if(this.edit == '1'){
                  <button mat-mini-fab aria-label='Example icon button with a menu icon'
                    style='background-color: rgb(245, 188, 0)' matTooltip='Modificar el registro'
                    (click)='updategestion_oficios(element.id_gestion_oficios,element.id_oficios,element.estatus)'>
                    <mat-icon style='color: rgb(0, 0, 0)'>edit</mat-icon>
                  </button>
                  } -->

                  <!-- @if(this.elim == '1'){
                  <button mat-mini-fab aria-label='Example icon button with a menu icon'
                    style='background-color: rgb(126, 0, 0)' matTooltip='Eliminar el registro'
                    (click)='Deletegestion_oficios(element.id_gestion_oficios)'>
                    <mat-icon style='color: rgb(255, 255, 255)'>delete</mat-icon>
                  </button>
                  } -->
                  }
                  @if(element.finalizado == '2'){
                  <p>El trámite está siendo evaluado</p>
                  }
                  @if(element.finalizado == '3'){
                  <p>Tramite Finalizado</p>
                  }
                  @if(element.finalizado == '4'){
                  <p>Tramite Evaluado con Errores</p>
                  <button mat-mini-fab aria-label='Example icon button with a menu icon'
                    style='background-color: rgb(126, 0, 0)' matTooltip='Ver Evaluacion'
                    (click)='editarVerificaciongestion_oficios(element.id_gestion_oficios,element.id_oficios)'>
                    <mat-icon style='color: rgb(255, 255, 255)'>edit_square</mat-icon>
                  </button>
                  }
                </div>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef='displayedColumns'></tr>
            <tr mat-row *matRowDef='let row; columns: displayedColumns'></tr>

          </table>


          <mat-paginator [pageSizeOptions]='[5, 10, 20]' showFirstLastButtons
            aria-label='Select page of periodic elements'>
          </mat-paginator>
        </div>
      </mat-card-content>
    </div>
  </mat-card>
</div>